@{
    ViewData["Title"] = "Tính Lương";
    var months = ViewBag.Months as List<SelectListItem>;
}
<h2>Tính Lương</h2>

<form asp-action="TinhLuong" method="post" class="col-md-6">
    <div class="row">
        <!-- Dropdown hiển thị danh sách tháng -->
        <select  id="monthDropdown" class="form-control" name="month" required>
            <option value="">Chọn tháng</option>
        </select>
    </div>
    @if (TempData["SuccessMessage"] != null)
    {
        <div class="alert alert-success">
            @TempData["SuccessMessage"]
        </div>
    }
    <div asp-validation-summary="All" class="text-danger"></div>
    <button type="submit" class="btn btn-primary">Tính lương</button>
    <a asp-action="Index">Quay lại</a>
</form>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script type="text/javascript">
    $(document).ready(function () {
        // Gọi AJAX để lấy danh sách tháng
        $.ajax({
            url: '@Url.Action("GetMonths", "Salary")', // Đường dẫn tới action
            type: 'GET',
            dataType: 'json',
            success: function (data) {
                // Xóa các tùy chọn hiện có trong dropdown
                $('#monthDropdown').empty();
                $('#monthDropdown').append('<option value="">Chọn tháng</option>');

                // Lặp qua dữ liệu và thêm vào dropdown
                $.each(data, function (index, item) {
                    $('#monthDropdown').append('<option value="' + item.value + '">' + item.text + '</option>');
                });
            },
            error: function (xhr, status, error) {
                alert("Đã có lỗi xảy ra: " + error);
            }
        });
    });
</script>